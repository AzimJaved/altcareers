<!DOCTYPE html>
<html>
    {% load json_tag %}
<head>
    <meta charset="UTF-8">
    <title>Result</title>
    <link rel="stylesheet" type="text/css" href="/static/style.css">
</head>

<body>
    <div id="container" class="container">
        <div style="margin-left:auto; margin-right:auto;">
            <h1 style="text-align:center;">GetBoarded on Success</h1>
            <h4 style="text-align:center;">Job Role Recommender and Job Readiness Report</h4>
            <hr>
        </div>

        {% if sen|length != 0 %}
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        {% for i,j,k in sen_tab %}
        <script type="text/javascript">
            var ref = document.createElement('div')
            ref.id = 'prediction{{k}}'
            document.getElementById('container').appendChild(ref);
            google.charts.load("current", { packages: ["sankey", "table"] });
            google.charts.setOnLoadCallback(drawChart);
            function drawChart() {
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'From');
                data.addColumn('string', 'To');
                data.addColumn('number', 'Weight');
                data.addRows(JSON.parse(`{{ i|json }}`));

                // Set chart options
                var colors = ['#a6cee3', '#b2df8a', '#fb9a99', '#fdbf6f',
                    '#cab2d6', '#ffff99', '#1f78b4', '#33a02c'];
                var options = {
                    width: 800,
                    height: 500,
                    sankey: {
                        link: { colorMode: 'gradient', color: { stroke: 'white', strokeWidth: 0.1 } },
                        node: {
                            width: 20, colors: colors, labelPadding: 30, nodePadding: 40,
                            label: {
                                color: '#01070a',
                                fontName: 'Times-Roman',
                                fontSize: 15,
                                bold: true,
                                italic: true
                            }
                        }
                    },
                };

                // Instantiate and draw our chart, passing in some options.
                ref = document.createElement('div')
                ref.id = 'sankey_multiple{{k}}'
                document.getElementById('prediction{{k}}').appendChild(ref)
                var chart = new google.visualization.Sankey(ref);
                chart.draw(data, options);
            }

            function drawChart2() {
                // Define the chart to be drawn.
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Job Role');
                data.addColumn('boolean', 'Ready');
                data.addColumn('boolean', 'Short-Term');
                data.addColumn('boolean', 'Long-Term');
                data.addRows(JSON.parse(`{{ j|json }}`));

                var options = {
                    showRowNumber: false,
                    width: '100%',
                    height: '100%'
                };

                // Instantiate and draw the chart.
                ref = document.createElement('div')
                ref.id = 'table-container{{k}}'
                document.getElementById('prediction{{k}}').appendChild(ref)
                var chart = new google.visualization.Table(ref);
                chart.draw(data, options);
            }
            google.charts.setOnLoadCallback(drawChart2);
        </script>
        {% endfor %}
        {% else %}
        <p>"Sorry! No job role could be predicted"</p>
        {% endif %}
    </div>
</body>

</html>